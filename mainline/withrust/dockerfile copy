FROM alpine:3.15 AS stage1
LABEL maintainer="ANSELME Containers <thiago@anselme.com.br>"

RUN apk add rust
WORKDIR /home/rust/app
VOLUME /home/rust/app

COPY app/ .
RUN rustc main.rs

FROM rust:alpine3.16 AS stage2
WORKDIR /home/rust/app
COPY --from=stage1 /home/rust/app/main .
ENTRYPOINT ["./main"]